<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A webpage dedicated to the developer team at Ryalto">
    <meta name="author" content="Sergios Papastergiou">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@200;400;500;600&display=swap" rel="stylesheet">

    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" sizes="16x16" href="../assets/images/favicon/favicon-16x16.png">
    <link rel="icon" sizes="32x32" href="../assets/images/favicon/favicon-32x32.png">
    <link rel="icon" sizes="512x512" href="../assets/images/favicon/facicon-512x512.png">

    <!-- Lottie Animation -->
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

    <!-- favicon here-->
    <script src="https://kit.fontawesome.com/0d939d98c3.js" crossorigin="anonymous"></script>
    <link href="../assets/css/prism.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css" type="text/css">
    <title>Ryalto Developer Page</title>
</head>

<body>
    <!-- Header -->
    <header class="container-fluid">
        <div class="row">
            <div class="col-12 col-sm-4 offset-sm-4 text-center">
                <a href="../index.html">
                    <img src="../assets/images/logos-and-icons/ryalto-logo-lg.png" width="200" height="75.31"
                        alt="ryalto-logo" loading="lazy">
                </a>
            </div>
            <div class="d-none d-sm-inline-block col-4 text-sm-right">
                <ul class="list-inline">
                    <li class="list-inline-item">
                        <a class="social" href="#">
                            <i class="fa-solid fa-globe fa-bounce" style="--fa-animation-iteration-count: 3;"></i>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a class="social" href="#">
                            <i class="fa-brands fa-github fa-bounce" style="--fa-animation-iteration-count: 3;"></i>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a class="social" href="#">
                            <i class="fa-brands fa-twitter fa-bounce" style="--fa-animation-iteration-count: 3;"></i>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a class="social" href="#">
                            <i class="fa-brands fa-linkedin fa-bounce" style="--fa-animation-iteration-count: 3;"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <nav class="navbar navbar-expand">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../index.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="../blogs-page.html">Blog <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Meet the Team</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Careers</a>
                </li>

            </ul>
        </nav>
    </header>

    <!-- Lottie Animation -->
    <div class="lottie-bg">
        <lottie-player class="lottie-animation"
            src="https://lottie.host/b6ae2926-020e-4c07-aa1c-4b79a653a491/wKjF4OiRZW.json" background="transparent"
            speed="1" loop autoplay></lottie-player>
    </div>

    <!-- Blog Full -->
    <article class="blog-full container-fluid">
        <div class="row">
            <div class="col-12 text-center gen-text">
                <h3>Hotwire Handbook Part 1</h3>
            </div>
        </div>
        <div class="row author-info pt-2 pb-2 rounded">
            <div class="col-6">
                <img class="author-photo float-right mt-0" src="../assets/images/team/team-member-4.webp" alt="team-member-4">
            </div>
            <div class="col-6 gen-text">
                <h5>Lois</h5>
                <p>22 March 2022</p>
                <ul class="list-inline">
                    <li class="list-inline-item">
                        <a class="social" href="#">
                            <i class="fa-brands fa-github"></i>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a class="social" href="#">
                            <i class="fa-brands fa-linkedin"></i>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a class="social" href="#">
                            <i class="fa-solid fa-envelope"></i>
                        </a>
                    </li>
                </ul>
            
            </div>
        </div>
        <div class="row">
            <div class="container">
                <div class="row">
                    <div class="col-12 text-justify gen-text">
                        <p>Recently I’ve been playing with Rails 7 and Hotwire.</p>
                        <p>This post is going to be published in stages and updated fairly regularly to complement the official Turbo Handbook and
                        the other great examples out there. Many of which are linked in the “Sources” Section.</p>
                        <h5>What can Hotwire do?</h5>
                        <p>Hotwire allows for advanced interactivity, normally reserved for JavaScript SPAs, but with faster first-load times and a
                        drastically simpler, more productive and happier developer experience.</p>
                        <p>Hotwire can do a lot, advanced interactivity and content updates without page updates. This handbook is going to touch
                        the surface of its capabilities. We’re going to look at:</p>
                        <ul>
                            <li>
                                <a href="#toggle-buttons">Toggle buttons</a>
                            </li>
                            <li>
                                <a href="#content-updates">Content Updates</a>
                            </li>
                            <li>
                                <a href="#live-counters">Live Counters</a>
                            </li>
                            <li>
                                <a href="blog-post-5.html">Pagination</a>
                            <li>Global Counters</li>
                            <li>Global Live Content Updates</li>
                  
                                  <li>Inline Editing</li>
                            <li>Tabbed Content</li>
                            <li>Modals</li>
                        </ul>
                        <h5>What is Turbo</h5>
                        <p><a href="https://turbo.hotwired.dev" target="_blank">Turbo</a> is part of <a href="https://hotwired.dev" target="_blank">Hotwire</a>. Hotwire is HTML-over-the-wire, a modern approach to building web app which sends HTML instead
                        of JSON to the browser. Why? Less JavaScript, smaller packet sizes, faster page load times and better developer
                        experience (in my opinion). You can read more of the why on hotwired.dev</p>
                        <p>Turbo is the spiritual successor to Turbolinks. <a href="https://turbo.hotwired.dev" target="_blank">Hotwired.dev</a> says:</p><p class="quote">The heart of Hotwire is Turbo. A set of complementary techniques for speeding up page changes and form submissions,
                        dividing complex pages into components, and stream partial page updates over WebSocket. All without writing any
                        JavaScript at all. And designed from the start to integrate perfectly with native hybrid applications for iOS and
                        Android.</p>
                        <h5>Prerequisites, Presumptions and how this handbook is laid out</h5>
                        <p>This handbook presumes that you have a familiarity with Ruby on Rails, MVC web app frameworks and have installed
                        turbo-rails following the steps <a href="https://github.com/hotwired/turbo-rails#installation" target="_blank">here</a>.</p>
                        <p>Each section of this handbook has a brief introduction, it will then give all the relevant code for context. I’ll then
                        dig into the key bits of each code sample. The code can all be viewed with full context in the DailyBrew GitHub repo
                        below.</p>
                        <h5>Sources, References and Research</h5>
                        <p>Official Docs: <a href="https://hotwired.dev/" target="_blank">https://hotwired.dev/</a>
                        <br>
                        Community: <a href="https://discuss.hotwired.dev/" target="_blank">https://discuss.hotwired.dev/</a>
                        <br>
                        David Colby: <a href="https://www.colby.so/" target="_blank">https://www.colby.so/</a>
                        <br>
                        Sean P Doyle, Thoughtbot Hotwire Example: <a href="https://github.com/thoughtbot/hotwire-example-template" target="_blank">https://github.com/thoughtbot/hotwire-example-template</a>
                        <br>
                        All the code examples here are part of the Daily Brew project and can be viewed in context here:
                        <a href="https://github.com/phil-6/dailybrew" target="_blank">https://github.com/phil-6/dailybrew</a></p>
                        <h5 id="toggle-buttons">Toggle Buttons</h5>
                        <p>(as Turbo Streams)</p>
                        <p>The user clicks a button, which updates something in our database, and we want this to be reflected on the front end.
                        (Without using JavaScript)</p>
                        <p>This is used in a few places in Daily Brew. The subscription page and favourites toggles are the ones we’re going to
                        look at in this handbook. The simpler example is the subscription toggle.</p>
                        <p><strong>Core Concept:</strong> Controller responds to Turbo Stream request format, and re-renders the partial which contains the button.
                        The button has an erb conditional based on the value which has been updated.</p>
                        <img class="mt-2 mb-2 in-blog-content" src="/assets/images/content/hh-sub-toggle.gif" alt="gif of toggling subscription button">
                        <h6>Code</h6>
                        <p><strong>Parent View</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/views/pages/subscription.html.erb">app/views/pages/subscription.html.erb</a>
                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> render <span class="token string-literal"><span class="token string">'subscription_interest_toggle'</span></span> </span><span class="token delimiter punctuation">%&gt;</span></span></code></pre>
                        <p><strong>Button Partial</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/views/pages/_subscription_interest_toggle.html.erb">app/views/pages/_subscription_interest_toggle.html.erb</a>
                        <pre class="language-erb" tabindex="0"><code class="language-erb"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>subscription_interest_toggle<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                          <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">if</span> current_user<span class="token operator">&amp;.</span>subscription_interest </span><span class="token delimiter punctuation">%&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> button_to update_subscription_interest_path<span class="token punctuation">,</span>
                                          <span class="token symbol">method</span><span class="token operator">:</span> <span class="token symbol">:patch</span><span class="token punctuation">,</span>
                                          <span class="token symbol">params</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token symbol">user</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">subscription_interest</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                                          <span class="token symbol">class</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"btn btn-complementary"</span></span> <span class="token keyword">do</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                              I'm not interested anymore
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">end</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                          <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">else</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> button_to update_subscription_interest_path<span class="token punctuation">,</span>
                                          <span class="token symbol">method</span><span class="token operator">:</span> <span class="token symbol">:patch</span><span class="token punctuation">,</span>
                                          <span class="token symbol">params</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token symbol">user</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">subscription_interest</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                                          <span class="token symbol">class</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"btn btn-complementary"</span></span> <span class="token keyword">do</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                              I'm In!
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">end</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                          <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">end</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                        </code></pre>
                        <p><strong>Controller (excerpt)</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/controllers/registrations_controller.erb">app/controllers/registrations_controller.erb</a>
                        
                        <pre class="language-ruby" tabindex="0"><code class="language-ruby"><span class="token comment"># app/controllers/registrations_controller.rb</span>
                        <span class="token keyword">class</span> <span class="token class-name">RegistrationsController</span> <span class="token operator">&lt;</span> Devise<span class="token double-colon punctuation">::</span>RegistrationsController
                          <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">update_subscription_interest</span></span>
                            current_user<span class="token punctuation">.</span>update<span class="token operator">!</span><span class="token punctuation">(</span>subscription_interest_params<span class="token punctuation">)</span>
                        
                            respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
                              format<span class="token punctuation">.</span>turbo_stream <span class="token keyword">do</span>
                                render turbo_stream<span class="token operator">:</span> turbo_stream<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>
                                  <span class="token string-literal"><span class="token string">'subscription_interest_toggle'</span></span><span class="token punctuation">,</span>
                                  <span class="token symbol">partial</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'pages/subscription_interest_toggle'</span></span>
                                <span class="token punctuation">)</span>
                              <span class="token keyword">end</span>
                            <span class="token keyword">end</span>
                          <span class="token keyword">end</span>
                        <span class="token keyword">end</span>
                        </code></pre>

                        <h5>Key Bits</h5>
                        <p>The key part here are the in the turbo stream response, which renders a turbo stream.</p>

                        <pre class="language-ruby" tabindex="0"><code class="language-ruby">turbo_stream<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>
                                  <span class="token string-literal"><span class="token string">'subscription_interest_toggle'</span></span><span class="token punctuation">,</span>
                                  <span class="token symbol">partial</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'pages/subscription_interest_toggle'</span></span>
                                <span class="token punctuation">)</span></code></pre>

                        <p>“replace” is the <a href="https://turbo.hotwired.dev/handbook/streams#stream-messages-and-actions">action</a>. The partial in the response will replace the existing element with the target DOM ID.
                        'subscription_interest_toggle' is the HTML ID which the stream is targeting and the partial is what the target is going
                        to be replaced with.</p>
                        <p>You could move the conditional to the controller, which would remove some logic from the view, however by doing it this
                        way the response doesn’t have to worry which view to render, as it just reloads the button partial.</p>
                        <h5 id="content-updates">Content Updates</h5>
                        <p>The way the favourites toggle works is very similar to the subscription toggle. The differences are that it's a create /
                        destroy action instead of an update, and the turbo stream is extracted to and erb partial.</p>
                        <p>There are quite a few partials here. This structure is broken down more than it needs to be as we reuse the coffee
                        partial in quite a few different places throughout the app. I’ll explain the key code snippets in more details below the
                        larger examples which are included for additional context.</p>
                        <h6>Code</h6>
                        <p><strong>Toggle Button Partial</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/views/favourites/_favourite_toggle.html.erb">app/views/favourites/_favourite_toggle.html.erb</a>

                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favourite_toggle_<span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> dom_id<span class="token punctuation">(</span>coffee<span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                          <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">if</span> current_user<span class="token operator">&amp;.</span>favourites<span class="token punctuation">.</span>find_by<span class="token punctuation">(</span><span class="token symbol">coffee</span><span class="token operator">:</span> coffee<span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> button_to delete_favourite_path<span class="token punctuation">(</span>coffee<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token symbol">method</span><span class="token operator">:</span> <span class="token symbol">:delete</span><span class="token punctuation">,</span> <span class="token symbol">class</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'link link-primary link-icon icon-line-1-4'</span></span> <span class="token keyword">do</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tooltip-parent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon-basic-heart-1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tooltip-content right delay-slow<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Remove from your favourites<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">end</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                          <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">else</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> button_to create_favourite_path<span class="token punctuation">(</span>coffee<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token symbol">method</span><span class="token operator">:</span> <span class="token symbol">:post</span><span class="token punctuation">,</span> <span class="token symbol">class</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'link link-primary link-icon icon-line-1-4'</span></span> <span class="token keyword">do</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tooltip-parent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon-basic-heart<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tooltip-content right delay-slow<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Add to your favourites<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">end</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                          <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">end</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre>

                        <p><strong>Parent View</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/views/dashboard/index.html.erb">app/views/dashboard/index.html.erb</a>

                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row stats<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favourites_count<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> current_user<span class="token punctuation">.</span>favourites<span class="token punctuation">.</span>count </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span> favourites
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favourites<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> link_to <span class="token string-literal"><span class="token string">'Your Favourites'</span></span><span class="token punctuation">,</span> favourites_path<span class="token punctuation">,</span> <span class="token symbol">class</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'link link-white link-title'</span></span> </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dashboard_favourites<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>shelf row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                              <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token variable">@favourites</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>coffee<span class="token operator">|</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                                <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> render <span class="token string-literal"><span class="token string">'favourites/favourite'</span></span><span class="token punctuation">,</span> <span class="token symbol">coffee</span><span class="token operator">:</span> coffee </span><span class="token delimiter punctuation">%&gt;</span></span>
                              <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">end</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span></code></pre>

                        <p><strong>Favourite Partial</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/views/favourites/_favourite.html.erb">app/views/favourites/_favourite.html.erb</a>

                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dashboard_favourites_<span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> dom_id<span class="token punctuation">(</span>coffee<span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favourite<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                          <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> render partial<span class="token operator">:</span> <span class="token string-literal"><span class="token string">'coffees/coffee'</span></span><span class="token punctuation">,</span> <span class="token symbol">locals</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">coffee</span><span class="token operator">:</span> coffee <span class="token punctuation">}</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre>

                        <p><strong>Coffee Partial</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/views/coffees/_coffee.html.erb">app/views/coffees/_coffee.html.erb</a>
                        <p><strong>Controller</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/controllers/favourites_controller.rb">app/controllers/favourites_controller.rb</a>
                        
                        <pre class="language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">FavouritesController</span> <span class="token operator">&lt;</span> ApplicationController
                          <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">index</span></span>
                            <span class="token variable">@favourites</span> <span class="token operator">=</span> current_user<span class="token punctuation">.</span>favourite_coffees
                          <span class="token keyword">end</span>
                        
                          <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">create</span></span>
                            <span class="token variable">@favourite</span> <span class="token operator">=</span> Favourite<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token symbol">user</span><span class="token operator">:</span> current_user<span class="token punctuation">,</span> <span class="token symbol">coffee_id</span><span class="token operator">:</span> params<span class="token punctuation">[</span><span class="token symbol">:coffee_id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                            <span class="token variable">@coffee</span> <span class="token operator">=</span> <span class="token variable">@favourite</span><span class="token punctuation">.</span>coffee
                        
                            respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
                              format<span class="token punctuation">.</span>turbo_stream
                            <span class="token keyword">end</span>
                          <span class="token keyword">end</span>
                        
                          <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">destroy</span></span>
                            <span class="token variable">@favourite</span> <span class="token operator">=</span> Favourite<span class="token punctuation">.</span>find_by<span class="token punctuation">(</span><span class="token symbol">user</span><span class="token operator">:</span> current_user<span class="token punctuation">,</span> <span class="token symbol">coffee_id</span><span class="token operator">:</span> params<span class="token punctuation">[</span><span class="token symbol">:coffee_id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                            <span class="token variable">@coffee</span> <span class="token operator">=</span> <span class="token variable">@favourite</span><span class="token punctuation">.</span>coffee
                            <span class="token variable">@favourite</span><span class="token punctuation">.</span>destroy
                        
                            respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
                              format<span class="token punctuation">.</span>turbo_stream
                            <span class="token keyword">end</span>
                          <span class="token keyword">end</span>
                        <span class="token keyword">end</span></code></pre>

                        <p><strong>Create Turbo Stream</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/views/favourites/create.turbo_stream.erb">app/views/favourites/create.turbo_stream.erb</a>
                        
                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>
                              <span class="token string-literal"><span class="token string">"favourite_toggle_</span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">dom_id<span class="token punctuation">(</span><span class="token variable">@coffee</span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">partial</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'favourite_toggle'</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">locals</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">coffee</span><span class="token operator">:</span> <span class="token variable">@coffee</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                        
                        <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span>update<span class="token punctuation">(</span>
                              <span class="token string-literal"><span class="token string">"favourites_count"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">html</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">%(</span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">current_user<span class="token punctuation">.</span>favourites<span class="token punctuation">.</span>count</span><span class="token delimiter punctuation">}</span></span><span class="token string">)</span></span> <span class="token punctuation">)</span></span><span class="token delimiter punctuation">%&gt;</span></span>
                        
                        <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span><span class="token keyword">prepend</span><span class="token punctuation">(</span>
                              <span class="token string-literal"><span class="token string">'dashboard_favourites'</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">partial</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'favourite'</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">locals</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">coffee</span><span class="token operator">:</span> <span class="token variable">@coffee</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span></code></pre>

                        <p><strong>Destroy Turbo Stream</strong></p>
                        <a href="https://github.com/phil-6/dailybrew/blob/main/app/views/favourites/destroy.turbo_stream.erb">app/views/favourites/destroy.turbo_stream.erb</a>
                        
                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"dashboard_favourites_</span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">dom_id<span class="token punctuation">(</span><span class="token variable">@coffee</span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                        
                        <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>
                              <span class="token string-literal"><span class="token string">"favourite_toggle_</span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">dom_id<span class="token punctuation">(</span><span class="token variable">@coffee</span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">partial</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"favourite_toggle"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">locals</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">coffee</span><span class="token operator">:</span> <span class="token variable">@coffee</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                        
                        <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span>update<span class="token punctuation">(</span>
                              <span class="token string-literal"><span class="token string">"favourites_count"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">html</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">%(</span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">current_user<span class="token punctuation">.</span>favourites<span class="token punctuation">.</span>count</span><span class="token delimiter punctuation">}</span></span><span class="token string">)</span></span> <span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span></code></pre>

                        <h5>Explanation</h5>
                        <p>We can see that the controller just responds with a turbo stream format.turbo_stream. It then looks for a turbo stream
                        with a matching name in the correct view folder.</p>

                        <pre class="language-ruby" tabindex="0"><code class="language-ruby">respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
                            format<span class="token punctuation">.</span>turbo_stream
                        <span class="token keyword">end</span></code></pre>

                        <p>These responses do several actions. While you can respond with multiple streams directly from the controller, it’s
                        considered better practice to move these multi response streams to a partial.</p>
                        <p><strong>Toggle Buttons Again</strong></p>
                        <p>These responses do several actions. While you can respond with multiple streams directly from the controller, it’s
                        considered better practice to move these multi response streams to a partial.</p>

                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>
                              <span class="token string-literal"><span class="token string">"favourite_toggle_</span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">dom_id<span class="token punctuation">(</span><span class="token variable">@coffee</span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">partial</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"favourite_toggle"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">locals</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">coffee</span><span class="token operator">:</span> <span class="token variable">@coffee</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span></code></pre>

                        <img class="mt-2 mb-2 in-blog-content" src="../assets/images/content/hh-fav-toggle.gif" alt="gif toggle favourite button">
                        <img class="mt-2 mb-2 in-blog-content" src="../assets/images/content/hh-shelf-toggle.gif" alt="gif toggle shelf button">
                        <p>The next thing that these responses do is a prepend or remove action. So this either adds a partial or removes it from
                        the DOM.</p>
                        <p><strong>Content Updates</strong></p>
                        <p>Looking at the create action first; this targets the dashboard_favourites ID. The favourite partial is prepended (added
                        inside the target element before the rest of the HTML), and the @coffee local variable is passed through to that
                        partial.</p>
                        <p>Turbo Stream</p>

                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>
                              <span class="token string-literal"><span class="token string">"favourite_toggle_</span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">dom_id<span class="token punctuation">(</span><span class="token variable">@coffee</span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">partial</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"favourite_toggle"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">locals</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">coffee</span><span class="token operator">:</span> <span class="token variable">@coffee</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span></code></pre>

                        <p>Target Element</p>

                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dashboard_favourites<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>shelf row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"><span class="token comment"># New partial is inserted here </span></span><span class="token delimiter punctuation">%&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token variable">@favourites</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>coffee<span class="token operator">|</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                                <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> render <span class="token string-literal"><span class="token string">'favourites/favourite'</span></span><span class="token punctuation">,</span> <span class="token symbol">coffee</span><span class="token operator">:</span> coffee </span><span class="token delimiter punctuation">%&gt;</span></span>
                            <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span><span class="token ruby language-ruby"> <span class="token keyword">end</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre>
                       
                        <img class="mt-2 mb-2 in-blog-content" src="../assets/images/content/hh-content-updates.gif" alt="gif showing content being added and removed with turbo streams">
                        <p>The destroy content update is simple, it looks for the first element in the DOM with the specified ID, in this case
                        dashboard_favourites_#{dom_id(@coffee)}, and removes it.</p>
                        <img class="mt-2 mb-2 in-blog-content" src="../assets/images/content/hh-content-remove.gif" alt="gif showing content being removed with turbo streams">
                        <p>The final thing that these responses do is update live counters</p>
                        <h5 id="live-counters">Live Counters</h5>
                        <p>As part of the Turbo Stream response from the controller we have an “update” action.</p>

                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> turbo_stream<span class="token punctuation">.</span>update<span class="token punctuation">(</span>
                              <span class="token string-literal"><span class="token string">"favourites_count"</span></span><span class="token punctuation">,</span>
                              <span class="token symbol">html</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">%(</span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">current_user<span class="token punctuation">.</span>favourites<span class="token punctuation">.</span>count</span><span class="token delimiter punctuation">}</span></span><span class="token string">)</span></span> <span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%&gt;</span></span></code></pre>

                        <p>The “Replace” action, as per the <a href="https://turbo.hotwired.dev/handbook/streams#stream-messages-and-actions" target="_blank">Turbo Handbook</a>:</p>
                        <p class="quote">The contents of this template will replace the contents of the element with ID "unread_count" by setting innerHtml to ""
                        and then switching in the template contents. Any handlers bound to the element "unread_count" would be retained. This is
                        to be contrasted with the "replace" action above, where that action would necessitate the rebuilding of handlers.</p>
                        <p>So it targets the element with ID favourites_count and swaps the HTML.</p>

                        <pre class="language-erb"
                            tabindex="0"><code class="language-erb"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favourites_count<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span><span class="token ruby language-ruby"> current_user<span class="token punctuation">.</span>favourites<span class="token punctuation">.</span>count </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span></code></pre>

                        <p>The new HTML is the same as the old, but by reloading it the erb is executed again and the counter is updated.</p>
                        <p>That's it for now. More coming soon. Feedback, thoughts and corrections <a href="mailto:hotwirehandbook@philreynolds.email" target="_blank">get in touch</a></p>
                    </div>
                </div>
            </div>
        </div>
    </article>

    <!-- Previous/Next Buttons -->
    <div class="container mt-5">
        <div class="row">
            <div class="col-6 text-center ">
                <a href="blog-post-1.html">
                    <button class="btn home-page-btn">Previous</button>
                </a>
            </div>
            <div class="col-6 text-center">
                <a href="blog-post-3.html">
                    <button class="btn home-page-btn">Next</button>
                </a>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="container-fluid bg-color-footer mt-5">
        <div class="row">
            <div class="col text-center">
                <a href="index.html">
                    <img src="../assets/images/logos-and-icons/logo-small.png" alt="ryalto-logo-small" width="100"
                        height="100">
                </a>
            </div>
        </div>
        <div class="row">
            <div class="col text-center gen-text">
                <p>© Copyright 2023</p>
            </div>
        </div>
    </footer>
    <script src="../assets/js/prism.js"></script>
</body>

</html>